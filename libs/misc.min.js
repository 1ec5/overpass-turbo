/* ---
 * Base64 encode / decode
 * initial version fom http://www.webtoolkit.info/
 * modified to support more url friendly variant "base64url".
 * modified to include Base64 for decimal numbers.
 * modified to support native (= much faster) base64 encoders
 * ---
 * lzw_* taken from jsolait library (http://jsolait.net/), LGPL
 * slightly modified to support utf8 strings.
 */function lzw_encode(e){e=unescape(encodeURIComponent(e));var t={},n=(e+"").split(""),r=[],i,s=n[0],o=256;for(var u=1;u<n.length;u++)i=n[u],t[s+i]!=null?s+=i:(r.push(s.length>1?t[s]:s.charCodeAt(0)),t[s+i]=o,o++,s=i);r.push(s.length>1?t[s]:s.charCodeAt(0));for(var u=0;u<r.length;u++)r[u]=String.fromCharCode(r[u]);return r.join("")}function lzw_decode(e){var t={},n=(e+"").split(""),r=n[0],i=r,s=[r],o=256,u;for(var a=1;a<n.length;a++){var f=n[a].charCodeAt(0);f<256?u=n[a]:u=t[f]?t[f]:i+r,s.push(u),r=u.charAt(0),t[o]=i+r,o++,i=u}return decodeURIComponent(escape(s.join("")))}function htmlentities(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e,t){var n="";e=unescape(encodeURIComponent(e));if(typeof window.btoa=="function")n=window.btoa(e);else{var r,i,s,o,u,a,f,l=0;while(l<e.length)r=e.charCodeAt(l++),i=e.charCodeAt(l++),s=e.charCodeAt(l++),o=r>>2,u=(r&3)<<4|i>>4,a=(i&15)<<2|s>>6,f=s&63,isNaN(i)?a=f=64:isNaN(s)&&(f=64),n=n+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)+this._keyStr.charAt(f)}return t?n:this._convert_to_base64url(n)},decode:function(e){var t="";e=this._convert_to_base64nopad(e),e=e.replace(/[^A-Za-z0-9\+\/]/g,""),e+="==".substring(0,(4-e.length%4)%4);if(typeof window.btoa=="function")t=window.atob(e);else{var n,r,i,s,o,u,a,f=0;while(f<e.length)s=this._keyStr.indexOf(e.charAt(f++)),o=this._keyStr.indexOf(e.charAt(f++)),u=this._keyStr.indexOf(e.charAt(f++)),a=this._keyStr.indexOf(e.charAt(f++)),n=s<<2|o>>4,r=(o&15)<<4|u>>2,i=(u&3)<<6|a,t+=String.fromCharCode(n),u!=64&&(t+=String.fromCharCode(r)),a!=64&&(t+=String.fromCharCode(i))}return t=decodeURIComponent(escape(t)),t},encodeNum:function(e,t){var n="";if(e==0)return this._keyStr.icharAt(0);var r=!1;e<0&&(r=!0,e=Math.abs(e));while(e>0)n=this._keyStr.charAt(e%64)+n,e-=e%64,e/=64;return r&&(n="."+n),t?n:this._convert_to_base64url(n)},decodeNum:function(e){e=this._convert_to_base64nopad(e),e=e.replace(/[^A-Za-z0-9\+\/.]/g,"");var t=0,n=!1;e.charAt(0)=="."&&(n=!0,e=e.substr(1));for(var r=0;r<e.length;r++)t+=this._keyStr.indexOf(e.charAt(e.length-1-r))*Math.pow(64,r);return(n?-1:1)*t},_convert_to_base64url:function(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},_convert_to_base64nopad:function(e){return e.replace(/\-/g,"+").replace(/_/g,"/")},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode:function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}};
